<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graph Traveler API æµ‹è¯•å®¢æˆ·ç«¯</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fafafa;
        }
        
        .section h3 {
            color: #34495e;
            margin-top: 0;
        }
        
        input, textarea, button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .result {
            background-color: #ecf0f1;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ Graph Traveler API æµ‹è¯•å®¢æˆ·ç«¯</h1>
        
        <div class="section">
            <h3>ğŸ” æœåŠ¡çŠ¶æ€æ£€æŸ¥</h3>
            <button onclick="checkHealth()">æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€</button>
            <div id="healthResult" class="result"></div>
        </div>
        
        <div class="grid">
            <div class="section">
                <h3>ğŸ” å®ä½“æœç´¢</h3>
                <input type="text" id="searchQuery" placeholder="è¾“å…¥æœç´¢å…³é”®è¯ï¼Œå¦‚ï¼šå¼ ä»²æ™¯" value="å¼ ä»²æ™¯">
                <input type="number" id="searchLimit" placeholder="ç»“æœæ•°é‡é™åˆ¶" value="5" min="1" max="20">
                <button onclick="searchEntities()">æœç´¢å®ä½“</button>
                <div id="searchResult" class="result"></div>
            </div>
            
            <div class="section">
                <h3>ğŸ§  æ™ºèƒ½æ¨ç†æŸ¥è¯¢</h3>
                <textarea id="reasoningQuestion" placeholder="è¾“å…¥æ¨ç†é—®é¢˜ï¼Œå¦‚ï¼šå¼ ä»²æ™¯ä¸ä¼¤å¯’è®ºçš„å…³ç³»ï¼Ÿ" rows="3">å¼ ä»²æ™¯ä¸ä¼¤å¯’è®ºçš„å…³ç³»ï¼Ÿ</textarea>
                <button onclick="performReasoning()">æ‰§è¡Œæ™ºèƒ½æ¨ç†</button>
                <div id="reasoningResult" class="result"></div>
            </div>
        </div>
        
        <div class="grid">
            <div class="section">
                <h3>ğŸ¤– å¤šæ™ºèƒ½ä½“åä½œ</h3>
                <textarea id="agentQuery" placeholder="è¾“å…¥åä½œæŸ¥è¯¢ï¼Œå¦‚ï¼šåˆ†æå¼ æœºä¸ç‹å”å’Œçš„å…³ç³»" rows="3">åˆ†æå¼ æœºä¸ç‹å”å’Œçš„å…³ç³»</textarea>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
                    <input type="number" id="agentLimit" placeholder="ç»“æœæ•°é‡é™åˆ¶" value="20" min="1" max="50">
                    <input type="number" id="agentSearchLimit" placeholder="æœç´¢é™åˆ¶" value="15" min="1" max="30">
                    <input type="number" id="agentMaxDepth" placeholder="æœ€å¤§æ·±åº¦" value="3" min="1" max="5">
                    <select id="agentIncludeIndirect">
                        <option value="true">åŒ…å«é—´æ¥å…³ç³»</option>
                        <option value="false">ä»…ç›´æ¥å…³ç³»</option>
                    </select>
                </div>
                
                <button onclick="collaborativeQuery()">æ‰§è¡Œåä½œæŸ¥è¯¢</button>
                <div id="agentResult" class="result"></div>
            </div>
            
            <div class="section">
                <h3>ğŸ“Š Schema ä¿¡æ¯</h3>
                <button onclick="getSchema()">è·å–æ•°æ®åº“ Schema</button>
                <div id="schemaResult" class="result"></div>
            </div>
        </div>
        
        <div class="section">
            <h3>âš™ï¸ API é…ç½®</h3>
            <input type="text" id="apiBase" placeholder="API åŸºç¡€åœ°å€" value="http://localhost:8080/api/v1/graph">
            <div class="status" id="connectionStatus">å‡†å¤‡å°±ç»ª</div>
        </div>
    </div>

    <script>
        const getApiBase = () => document.getElementById('apiBase').value;
        
        const showStatus = (elementId, message, isSuccess = true) => {
            const element = document.getElementById(elementId);
            if (elementId === 'connectionStatus') {
                element.className = `status ${isSuccess ? 'success' : 'error'}`;
                element.textContent = message;
            } else {
                element.textContent = message;
            }
        };
        
        const makeRequest = async (endpoint, method = 'GET', body = null) => {
            try {
                const config = {
                    method,
                    headers: {
                        'Content-Type': 'application/json',
                    }
                };
                
                if (body) {
                    config.body = JSON.stringify(body);
                }
                
                const response = await fetch(`${getApiBase()}${endpoint}`, config);
                const data = await response.json();
                
                return {
                    success: response.ok,
                    data,
                    status: response.status
                };
            } catch (error) {
                return {
                    success: false,
                    error: error.message
                };
            }
        };
        
        const checkHealth = async () => {
            showStatus('connectionStatus', 'æ£€æŸ¥ä¸­...', true);
            
            const result = await makeRequest('/health');
            
            if (result.success) {
                showStatus('connectionStatus', `æœåŠ¡çŠ¶æ€: ${result.data.status}`, result.data.status === 'healthy');
                document.getElementById('healthResult').textContent = JSON.stringify(result.data, null, 2);
            } else {
                showStatus('connectionStatus', `è¿æ¥å¤±è´¥: ${result.error || 'æœåŠ¡ä¸å¯ç”¨'}`, false);
                document.getElementById('healthResult').textContent = `é”™è¯¯: ${result.error || 'æœåŠ¡ä¸å¯ç”¨'}`;
            }
        };
        
        const searchEntities = async () => {
            const query = document.getElementById('searchQuery').value;
            const limit = parseInt(document.getElementById('searchLimit').value) || 5;
            
            if (!query.trim()) {
                alert('è¯·è¾“å…¥æœç´¢å…³é”®è¯');
                return;
            }
            
            document.getElementById('searchResult').textContent = 'æœç´¢ä¸­...';
            
            const result = await makeRequest('/search/entities', 'POST', {
                query: query,
                limit: limit
            });
            
            if (result.success) {
                document.getElementById('searchResult').textContent = JSON.stringify(result.data, null, 2);
            } else {
                document.getElementById('searchResult').textContent = `é”™è¯¯: ${result.error || 'æœç´¢å¤±è´¥'}`;
            }
        };
        
        const performReasoning = async () => {
            const question = document.getElementById('reasoningQuestion').value;
            
            if (!question.trim()) {
                alert('è¯·è¾“å…¥æ¨ç†é—®é¢˜');
                return;
            }
            
            document.getElementById('reasoningResult').textContent = 'æ¨ç†ä¸­...';
            
            const result = await makeRequest('/reasoning/schema-aware', 'POST', {
                question: question
            });
            
            if (result.success) {
                document.getElementById('reasoningResult').textContent = JSON.stringify(result.data, null, 2);
            } else {
                document.getElementById('reasoningResult').textContent = `é”™è¯¯: ${result.error || 'æ¨ç†å¤±è´¥'}`;
            }
        };
        
        const collaborativeQuery = async () => {
            const query = document.getElementById('agentQuery').value;
            
            if (!query.trim()) {
                alert('è¯·è¾“å…¥åä½œæŸ¥è¯¢');
                return;
            }
            
            // è·å–ç”¨æˆ·é…ç½®çš„å‚æ•°
            const limit = parseInt(document.getElementById('agentLimit').value) || 20;
            const searchLimit = parseInt(document.getElementById('agentSearchLimit').value) || 15;
            const maxDepth = parseInt(document.getElementById('agentMaxDepth').value) || 3;
            const includeIndirect = document.getElementById('agentIncludeIndirect').value === 'true';
            
            document.getElementById('agentResult').textContent = 'åä½œæŸ¥è¯¢ä¸­...';
            
            const result = await makeRequest('/agents/collaborative-query', 'POST', {
                query: query,
                context: {
                    limit: limit,
                    searchLimit: searchLimit,
                    maxDepth: maxDepth,
                    includeIndirect: includeIndirect
                }
            });
            
            if (result.success) {
                document.getElementById('agentResult').textContent = JSON.stringify(result.data, null, 2);
            } else {
                document.getElementById('agentResult').textContent = `é”™è¯¯: ${result.error || 'åä½œæŸ¥è¯¢å¤±è´¥'}`;
            }
        };
        
        const getSchema = async () => {
            document.getElementById('schemaResult').textContent = 'è·å– Schema ä¸­...';
            
            const result = await makeRequest('/schema');
            
            if (result.success) {
                document.getElementById('schemaResult').textContent = JSON.stringify(result.data, null, 2);
            } else {
                document.getElementById('schemaResult').textContent = `é”™è¯¯: ${result.error || 'è·å– Schema å¤±è´¥'}`;
            }
        };
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥æœåŠ¡çŠ¶æ€
        window.onload = () => {
            checkHealth();
        };
    </script>
</body>
</html>